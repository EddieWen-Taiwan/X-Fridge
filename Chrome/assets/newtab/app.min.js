function FRIDGE(){var e=this;return e.UI=$("#right-part").find(".fridge"),e.fridge_down_open=e.UI.find(".fridge-down-open"),e.opener=e.UI.find(".fridge-down-holder"),e.opener.on("click",e,e.open),e}function INFO(){var e=this;return e.UI=$("#info"),e.name=e.UI.find(".name"),e.date=e.UI.find(".date"),e}function LIST(){var e=this;return e.UI=$("#list"),e.ADD=new LIST_ADD(e),e.UL=new LIST_UL(e),e.UL.readItem(),e}function LIST_ADD(e){var t=this;return t.parent=e,t.UI=t.parent.UI.find("#add"),t.food_name=t.UI.find(".food_name"),t.food_date=t.UI.find(".food_date"),t.food_quantity=t.UI.find(".food_quantity"),t.food_type=t.UI.find(".food_type"),t.add_item=t.UI.find(".add_item"),t.add_item.on("click",t,function(e){var t=e.data,o={name:t.food_name.val(),buydate:(new Date).stringFormat(),expire:t.food_date.val(),quantity:t.food_quantity.val(),type:t.food_type.val()};t.addItem(o)}),t}function LIST_UL(e){var t=this;t.parent=e,t.UI=t.parent.UI.find("#food-list"),t.CTN=t.UI.find(".food_list"),t.CTN.on("click",".delete",function(){t.deleteItem(this)})}function shift(e,t,o){var n=e[t];e[t]=e[o],e[o]=n}function supportLocalStorage(){return localStorage?!0:!1}Date.prototype.stringFormat=function(){var e=this.getFullYear(),t=this.getMonth()+1,o=this.getDate(),n="00";return e+"-"+(n+t).slice(-n.length)+"-"+(n+o).slice(-n.length)},FRIDGE.prototype.open=function(e){var t=e.data;t.fridge_down_door.toggleClass("open")},INFO.prototype.updateName=function(){var e=this,t=tool.read("username")||"Stranger";return e.name.text(t),e},INFO.prototype.updateDate=function(){var e=this,t=new Date;return e.date.text(t.getMonth()+1+"/"+t.getDate()),e},LIST.prototype.xxx=function(){var e=this;return e},LIST.prototype.ccc=function(){var e=this;return e},LIST_ADD.prototype.addItem=function(e){var t=this;tool.write("food",e),t.clearItem(),t.parent.UL.addItem(e)},LIST_ADD.prototype.clearItem=function(){var e=this;e.food_name.val(""),e.food_date.val(""),e.food_type.val(""),e.food_quantity.val("")},LIST_UL.prototype.addItem=function(e){var t=this,o=$('<li><div class="box"></div></li>'),n=$('<div class="food"></div>'),a=$('<div class="days"></div>'),r=$('<div class="num"></div>'),d=$('<div class="delete">－</div>');n.text(e.name),a.text(tool.ifexpired(e.expire)),r.text("x "+e.quantity),d.text(e.del),o.find(".box").append(n),o.find(".box").append(r),o.find(".box").append(a),o.find(".box").append(d),t.CTN.append(o)},LIST_UL.prototype.deleteItem=function(e){var t=$("li").index($(e).parent().parent());tool.remove("food",t),$(e).parent().parent().remove()},LIST_UL.prototype.readItem=function(){var e=this,t=tool.read("food");t.forEach(function(t){e.addItem(t)}),e.getnotice()},LIST_UL.prototype.getnotice=function(){var e=this,t=tool.read("food"),o=new Array(5);t.forEach(function(t,n){for(var n=5;n>=0&&5>=n;n--)if(null==o[n]||t.expire>o[n].expire){console.log(t.expire),o.splice(n,1,t.expire);break}e.addItem(t)}),console.log(o)},$(function(){function e(){o()?t():$("#askOverlay").remove(),window.INFO=new INFO,window.LIST=new LIST,window.FRIDGE=new FRIDGE,INFO.updateName().updateDate()}function t(){$("#askOverlay").removeClass("hidden"),$("#askOverlay").keypress(function(e){if(13==e.keyCode){var t=$("#askOverlay input").val();tool.write("username",t),INFO.updateName(),$(this).addClass("animated bounceOut")}})}function o(){return!tool.read("username")}e()}),window.username="",window.food="",window.food_arr=[],window.tool={read:function(e){if(!supportLocalStorage())return!1;switch(e){case"username":return username=localStorage.username,username;case"food":return food=localStorage.food,food_arr=JSON.parse(food),food_arr;default:return!0}},write:function(e,t){if(!supportLocalStorage())return!1;switch(e){case"username":return localStorage.username=t,!0;case"food":return food_arr.push(t),localStorage.food=JSON.stringify(food_arr),!0}},remove:function(e,t){if(!supportLocalStorage())return!1;switch(e){case"food":return food_arr.splice(t,1),food=JSON.stringify(food_arr),localStorage.food=food,!0}},ifexpired:function(e){var t=new Date(e),o=new Date,n=(t-o)/864e5;return n=1>n&&n>0?"即將過期":0>n?"已經過期":Math.round(parseInt(n))+" days"}};